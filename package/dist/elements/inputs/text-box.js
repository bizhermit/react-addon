"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var u=Object.getOwnPropertyDescriptor(t,r);u&&!("get"in u?!t.__esModule:u.writable||u.configurable)||(u={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,u)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.useTextBox=void 0;const string_utils_1=__importDefault(require("@bizhermit/basic-utils/dist/string-utils")),react_1=__importStar(require("react")),value_1=__importDefault(require("../../hooks/value")),css_var_1=__importDefault(require("../../styles/css-var")),input_style_1=__importStar(require("../../styles/input-style")),jsx_style_1=__importDefault(require("../../styles/jsx-style")),input_1=require("../../utils/input"),resizer_1=__importDefault(require("../resizer")),cn="bh-txb",TextBox=react_1.default.forwardRef(((e,t)=>{const r=(0,react_1.useRef)(),{val:a,set:u,buf:n}=(0,value_1.default)(e,{effect:e=>{r.current.value!==e&&(r.current.value=e??"")}}),l=t=>{e.$disabled||e.$readOnly||u.current(t)},c=(0,react_1.useRef)(a);return(0,react_1.useEffect)((()=>{e.$hook?._set({focus:()=>r.current?.focus(),getValue:()=>n.current,setValue:e=>u.current(e)})}),[e.$hook?._set]),react_1.default.createElement("div",{...(0,input_1.inputFieldAttributes)(e,cn),ref:t,"data-v":string_utils_1.default.isNotEmpty(a),"data-round":e.$round},react_1.default.createElement("input",{ref:r,type:e.$type,className:`${input_style_1.inputCn}_fld ${cn}_fld`,tabIndex:e.tabIndex,name:e.$name,disabled:e.$disabled,readOnly:e.$readOnly,autoComplete:e.$autoComplete,pattern:e.$pattern,maxLength:e.$maxLength,minLength:e.$minLength,required:e.$required,placeholder:e.placeholder,"data-align":e.$textAlign,onChange:t=>{const a=t.currentTarget.value,u=e.$changing?.(a);!1!==u?c.current=a:r.current.value=c.current??""},onBlur:e=>{l(e.currentTarget.value)},onKeyDown:e=>{switch(e.key){case"Enter":case"Tab":l(e.currentTarget.value);break;case"Escape":r.current.value=n.current}}}),e.$resize?react_1.default.createElement(resizer_1.default,{direction:"x"}):react_1.default.createElement(react_1.default.Fragment,null),e.children,input_style_1.default,Style)})),useTextBox=()=>{const e=(0,react_1.useRef)({});return{focus:(0,react_1.useCallback)((()=>{e.current.focus?.()}),[]),getValue:(0,react_1.useCallback)((()=>e.current.getValue?.()),[]),setValue:(0,react_1.useCallback)((t=>{e.current.setValue?.(t)}),[]),_set:(0,react_1.useCallback)((t=>{e.current=t}),[])}};exports.useTextBox=useTextBox;const Style=react_1.default.createElement(jsx_style_1.default,{id:cn},(()=>`\n.${cn}_fld {\n  flex: 1;\n}\n.${cn}[data-round="true"] > .${cn}_fld {\n  padding-left: calc(${css_var_1.default.size} / 2);\n  padding-right: calc(${css_var_1.default.size} / 2);\n}`));exports.default=TextBox;