"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var l=Object.getOwnPropertyDescriptor(t,a);l&&!("get"in l?!t.__esModule:l.writable||l.configurable)||(l={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,l)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&__createBinding(t,e,a);return __setModuleDefault(t,e),t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const number_utils_1=__importDefault(require("@bizhermit/basic-utils/dist/number-utils")),react_1=__importStar(require("react")),css_var_1=__importStar(require("../../../styles/css-var")),jsx_style_1=__importDefault(require("../../../styles/jsx-style")),dom_1=require("../../../utils/dom"),slider_1=__importStar(require("../../inputs/slider")),data_view_1=require("../data-view"),cn="bh-dv_c-sld",DataViewSliderColumn=e=>{let t={value:void 0};const a=e.labelDataName??`__${e.name}`,n=e.format??(e=>number_utils_1.default.format(e));return{dataType:"number",...e,name:a,vName:e.name,initializeRowData:t=>{t[a]=n(t[e.name])},initialize:()=>{const t=document.createElement("div");t.classList.add(cn),t.setAttribute("data-align",e.barAlign??"left"),e.hideBar&&(t.style.display="none");const a=document.createElement("div");return a.classList.add(`${data_view_1.dataViewCn}-lbl`,`${cn}-lbl`),{elem:a,belem:t}},cellInitialize:(t,a)=>{const n=(0,dom_1.cloneDomElement)(a.belem);if(t.contentElements.push(n),t.element.appendChild(n),!0!==e.hideLabel){const e=(0,dom_1.cloneDomElement)(a.elem);t.contentElements.push(e),t.element.appendChild(e)}},cellRender:({cache:t,row:n,contentElements:l})=>{if(t.val!==n.item.data[e.name]){const i=n.item.data[e.name];!0!==e.hideLabel&&(l[1].textContent=n.item.data[a]),e.progressbarRender?.(i,l[0]),t.val=i,l[0].style.width=`${Math.min(100,Math.max(0,i??0))}%`,e.color&&l[0].setAttribute("data-color",e.color(i))}},_beginEdit:e.disabled?void 0:({target:a})=>({node:react_1.default.createElement(EditColumn,{bind:t={value:a.data[e.name]},attrs:e.sliderAttributes}),effect:()=>{e.beganEdit?.(a.data[e.name],a)}}),_endEdit:(l,i)=>{const d=l.data[e.name],r=t.value;i&&(l.data[e.name]=r,l.data[a]=n(r)??""),e.endedEdit?.({before:d,after:i?r:d},l,i)},jsxStyle:Style}},EditColumn=({bind:e,attrs:t})=>{const a=(0,slider_1.useSlider)();return(0,react_1.useEffect)((()=>{a.focus()}),[]),react_1.default.createElement(slider_1.default,{...t,$hook:a,$name:"value",$bind:e,style:{height:"100%",width:"100%"}})},Style=react_1.default.createElement(jsx_style_1.default,{id:cn,depsDesign:!0},(({design:e})=>`\n.${cn} {\n  box-sizing: border-box;\n  position: absolute;\n  height: 60%;\n  top: 20%;\n  max-width: 100%;\n  z-index: -1;\n  background: ${css_var_1.default.hvrBgc};\n}\n.${cn}[data-align="left"] {\n  left: 0px;\n}\n.${cn}[data-align="right"] {\n  right: 0px;\n}\n${(0,css_var_1.switchDesign)(e,{c:`\n.${data_view_1.dataViewCn}-row[data-oddeven="odd"] .${cn} + .${cn}-lbl {\n  ${css_var_1.CssPV.textSd(css_var_1.default.dataview.cell.bg.b)}\n}\n.${data_view_1.dataViewCn}-row[data-oddeven="even"] .${cn} + .${cn}-lbl {\n  ${css_var_1.CssPV.textSd(css_var_1.default.dataview.cell.bg.d)}\n}\n.${data_view_1.dataViewCn}-row:hover .${cn} + .${cn}-lbl {\n  ${css_var_1.CssPV.textSd(css_var_1.default.dataview.cell.hvr.row.bgc)}\n}\n.${data_view_1.dataViewCn}-cell:hover .${cn} + .${cn}-lbl {\n  ${css_var_1.CssPV.textSd(css_var_1.default.dataview.cell.hvr.cell.bgc)}\n}\n.${data_view_1.dataViewCn}-body.bh-select-row .${data_view_1.dataViewCn}-row.bh-_selected .${cn} + .${cn}-lbl,\n.${data_view_1.dataViewCn}-body.bh-select-cell .${data_view_1.dataViewCn}-cell.bh-_selected .${cn} + .${cn}-lbl {\n  ${css_var_1.CssPV.textSd(css_var_1.default.dataview.cell.act.bgc)}\n}\n.${data_view_1.dataViewCn}-body.bh-select-row .${data_view_1.dataViewCn}-row.bh-_selected .${data_view_1.dataViewCn}-cell:hover .${cn} + .${cn}-lbl,\n.${data_view_1.dataViewCn}-body.bh-select-cell .${data_view_1.dataViewCn}-cell.bh-_selected:hover .${cn} + .${cn}-lbl {\n  ${css_var_1.CssPV.textSd(css_var_1.default.dataview.cell.act.hvr.bgc)}\n}\n${(0,css_var_1.colorIterator)(((e,t,a)=>`\n.${cn}${a} {\n  background: ${t.ipt.on};\n}\n`)).join("")}`})}\n`));exports.default=DataViewSliderColumn;